<?php// Prefill z posledného hľadania (recent_searches)require_once __DIR__ . '/../helpers/user_content.php';$ctx = getUserContext();$lastSearch = end($ctx['recent_searches']) ?: null;// doplň len prázdne / neexistujúce hodnoty vo $formDataif ($lastSearch) {  // typ / podtyp  if (empty($formData['advert_type_eu']) && !empty($lastSearch['advert_type_eu'])) {    // tvoje UI čaká pole pri advert_type_eu => [id]    $formData['advert_type_eu'] = [ (int)$lastSearch['advert_type_eu'] ];  }  if (empty($formData['advert_subtype_eu']) && !empty($lastSearch['advert_subtype_eu'])) {    $formData['advert_subtype_eu'] = is_array($lastSearch['advert_subtype_eu'])      ? $lastSearch['advert_subtype_eu']      : [ (int)$lastSearch['advert_subtype_eu'] ];  }  // cena  if (!isset($formData['advert_price_min']) && isset($lastSearch['price_from']) && $lastSearch['price_from'] !== '') {    $formData['advert_price_min'] = (int)$lastSearch['price_from'];  }  if (!isset($formData['advert_price_max']) && isset($lastSearch['price_to']) && $lastSearch['price_to'] !== '') {    $formData['advert_price_max'] = (int)$lastSearch['price_to'];  }  // lokalita – kódy  foreach (['locality_stat_kod','locality_kraj_kod','locality_okres_kod','locality_obec_kod'] as $k) {    if (!isset($formData[$k]) && !empty($lastSearch[$k])) {      $formData[$k] = $lastSearch[$k];    }  }  // lokalita – súradnice (ak ich tvoj dropdown používa)  if (!isset($formData['locality_latitude']) && isset($lastSearch['locality_latitude'])) {    $formData['locality_latitude'] = $lastSearch['locality_latitude'];  }  if (!isset($formData['locality_longitude']) && isset($lastSearch['locality_longitude'])) {    $formData['locality_longitude'] = $lastSearch['locality_longitude'];  }}?><section class="filter">  <form id="listing-form" method="POST" action="/search-form/">    <input type="hidden" name="oof" value="adfsdfsd">    <article class="container container--xlg" role="article">      <div class="filter__wrap" id="js-filter-wrap">            <!-- <div class="custom-select             custom-select--lg">             <select name="" id="filter-sell">             <option value="">Prodej</option>             <option value="">Prodej</option>             <option value="">Prodej</option>             <option value="">Prodej</option>             <option value="">Prodej</option>             <option value="">Prodej</option>             </select>             </div> -->        <?php include "filter-dropdown-city.php" ?>        <?php        echo $portal->render(          "filter-dropdown.php",          [            "propertySubTypes" => $portal->getCompanyTranslator()->getProperty($formData["advert_type_eu"][0] ?? 7),            "selected"         => $formData["advert_subtype_eu"] ?? [],            "formData"         => $formData          ]        );        ?>        <div class="filter__dropdown">          <div class="filter__dropdown-top">            <label for="">Cena</label>            <div class="filter__dropdown-selection" id="range-price-input">              Vyberte            </div>          </div>          <div class="filter__dropdown-inside">            <div class="range">              <div class="price-inputs price-inputs--filter">                <div class="price-inputs__item">                  <label for="price-from">Cena od</label>                  <input                    name="sql[advert_price_min]"                    type="number"                    id="rangeslider-from"                    value="<?php                    echo htmlspecialchars(                      (string)($formData['advert_price_min'] ?? '0'),                      ENT_QUOTES, 'UTF-8'                    );                    ?>"                  >                </div>                <div class="price-inputs__item">                  <label for="price-to">Cena do</label>                  <input                    name="sql[advert_price_max]"                    type="number"                    id="rangeslider-to"                    value="<?php                    echo htmlspecialchars(                      (string)($formData['advert_price_max'] ?? '30000000'),                      ENT_QUOTES, 'UTF-8'                    );                    ?>"                  >                </div>              </div>              <div class="range__slider" id="rangeslider"></div>            </div>            <button class="btn btn--just-icon filter__dropdown--float-close js-property-close-btn" type="button">              <div class="icon icon--icon-times">                <svg class="icon__svg"><use xlink:href="#icon-times"></use></svg>              </div>            </button>            <button class="btn btn--sm filter__dropdown--float-btn js-property-close-btn" type="button">Potvrdit</button>          </div>        </div>        <div class="filter__props">          <label for="">Vlastnosti:</label>          <div class="badge-wrap badge-wrap--filter">            <a href="#search-advanced" class="badge badge--light js-modal-open">Vyberte</a>          </div>        </div>        <button class="btn btn--md filter__end" type="submit">Zobrazit</button>      </div>    </article>  </form></section>